
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  ** This notice applies to any and all portions of this file
  * that are not between comment pairs USER CODE BEGIN and
  * USER CODE END. Other portions of this file, whether 
  * inserted by the user or by software development tools
  * are owned by their respective copyright owners.
  *
  * COPYRIGHT(c) 2018 STMicroelectronics
  *
  * Redistribution and use in source and binary forms, with or without modification,
  * are permitted provided that the following conditions are met:
  *   1. Redistributions of source code must retain the above copyright notice,
  *      this list of conditions and the following disclaimer.
  *   2. Redistributions in binary form must reproduce the above copyright notice,
  *      this list of conditions and the following disclaimer in the documentation
  *      and/or other materials provided with the distribution.
  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  *      may be used to endorse or promote products derived from this software
  *      without specific prior written permission.
  *
  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
  ******************************************************************************
  */
/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "stm32l4xx_hal.h"

/* USER CODE BEGIN Includes */

/* USER CODE END Includes */

/* Private variables ---------------------------------------------------------*/
DAC_HandleTypeDef hdac1;

TIM_HandleTypeDef htim2;

UART_HandleTypeDef huart1;
DMA_HandleTypeDef hdma_usart1_rx;
DMA_HandleTypeDef hdma_usart1_tx;

/* USER CODE BEGIN PV */
/* Private variables ---------------------------------------------------------*/

/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_DMA_Init(void);
static void MX_DAC1_Init(void);
static void MX_TIM2_Init(void);
static void MX_USART1_UART_Init(void);

/* USER CODE BEGIN PFP */
/* Private function prototypes -----------------------------------------------*/

/* USER CODE END PFP */

/* USER CODE BEGIN 0 */
int audioData[5000] = {512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,508,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,512,512,516,512,512,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,512,516,512,512,512,512,512,512,512,512,512,512,512,512,508,512,512,512,512,512,512,512,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,516,512,512,512,512,512,512,508,512,512,512,508,512,512,512,512,512,512,512,516,512,512,512,512,512,512,508,512,512,508,512,512,512,512,512,512,516,516,512,512,512,512,512,512,512,512,512,508,508,512,512,512,512,512,512,516,516,512,516,512,512,512,508,512,508,508,512,512,512,512,512,512,512,520,512,512,512,512,512,512,512,508,512,512,508,508,512,512,512,512,516,516,512,512,512,512,512,508,508,512,512,512,504,512,512,512,512,512,512,520,516,512,516,512,512,512,508,508,516,512,508,512,512,512,516,512,508,520,512,512,512,512,512,512,512,508,512,512,508,508,512,512,516,512,512,512,516,516,512,512,512,516,512,504,512,512,512,508,512,512,512,512,512,512,516,512,512,512,516,520,508,512,512,512,508,512,508,512,516,512,508,512,512,512,516,516,512,512,512,508,512,512,512,512,508,512,512,512,508,512,512,512,516,512,512,516,512,516,512,512,504,512,508,512,512,508,512,508,512,508,516,512,512,520,516,508,504,512,520,520,512,500,508,512,516,512,512,512,512,512,512,512,516,520,516,512,512,512,512,516,512,504,512,512,504,512,516,524,512,500,504,512,520,508,508,504,516,520,500,496,512,532,520,504,516,520,524,508,504,508,516,524,508,508,512,520,524,524,516,516,528,512,512,512,504,504,504,512,512,516,508,512,520,516,508,512,516,528,512,532,516,536,496,548,320,168,392,652,684,468,420,520,624,600,524,480,536,524,472,492,592,612,520,444,296,336,516,636,584,468,500,592,608,568,568,600,592,512,440,456,528,552,480,408,460,564,584,536,548,552,500,472,512,560,568,492,432,412,456,492,492,496,516,548,532,520,528,572,584,548,464,456,544,604,556,440,400,516,616,536,436,476,580,580,524,520,600,628,528,428,444,544,560,480,432,484,544,544,484,404,448,588,696,584,344,260,444,668,660,472,356,408,528,576,568,568,516,452,444,508,536,540,520,512,532,504,408,372,504,648,664,528,356,368,524,660,628,484,424,532,604,544,504,508,564,560,484,432,476,544,536,496,492,516,512,496,484,500,512,500,484,480,464,484,556,580,512,428,440,500,508,472,440,464,496,488,432,440,508,548,524,500,528,544,524,512,560,636,652,576,516,528,560,552,540,512,496,500,536,568,568,540,520,524,544,572,548,528,512,504,472,440,456,508,512,496,500,512,528,500,456,412,416,440,472,488,528,556,524,460,420,452,496,520,516,512,528,556,556,536,520,544,608,672,628,552,544,572,548,512,528,532,500,432,412,476,536,556,556,552,532,512,512,532,544,540,516,468,404,384,428,492,508,504,512,496,456,420,424,492,544,556,536,492,428,396,432,512,580,608,588,564,536,500,500,560,604,556,504,468,464,484,504,504,512,504,464,428,472,560,604,560,512,480,468,508,536,552,560,552,524,500,488,488,528,572,580,548,532,560,552,528,512,528,532,512,480,488,548,604,604,572,556,512,456,412,412,484,576,588,520,452,404,384,372,416,488,540,548,520,508,508,500,472,464,488,492,488,488,516,556,572,556,536,536,528,508,480,508,536,544,524,516,528,512,492,504,532,528,532,536,528,508,508,520,524,512,484,468,488,508,516,536,540,512,472,452,472,520,536,540,532,528,504,468,428,424,444,468,512,544,568,568,556,508,476,480,504,524,540,564,556,544,504,472,480,532,580,612,612,572,512,456,440,480,536,588,600,572,520,460,436,444,492,548,596,584,544,496,444,400,416,476,532,564,548,532,508,504,472,484,520,548,532,504,504,480,492,480,520,528,512,504,476,480,472,476,508,556,556,516,512,516,520,528,564,576,520,516,488,516,508,516,512,536,516,484,480,484,484,480,508,528,520,496,488,496,488,460,492,540,580,552,528,524,516,500,492,524,540,524,500,488,496,524,536,544,568,552,508,488,512,544,556,564,552,516,468,436,440,484,508,516,536,524,500,468,476,492,524,544,560,548,520,508,496,508,512,516,508,512,512,500,496,504,492,472,448,440,444,472,496,516,536,528,504,484,476,464,472,488,504,516,536,536,532,532,532,528,528,516,512,512,528,532,524,544,560,564,556,568,580,576,564,556,552,552,552,556,560,560,548,540,552,560,552,544,548,556,548,540,516,516,512,504,496,504,504,484,472,452,440,432,444,444,428,404,372,344,332,336,328,320,316,316,324,336,360,392,420,440,456,480,504,528,564,588,608,624,616,608,604,628,656,700,748,772,760,704,656,652,684,716,740,776,804,788,724,660,636,656,692,700,688,668,632,604,576,580,608,664,656,376,128,16,40,60,132,296,444,464,388,280,244,344,436,516,576,620,548,448,324,268,292,408,476,508,520,500,444,420,452,508,576,632,644,624,604,588,596,624,644,656,680,696,696,676,668,664,680,704,732,748,764,784,772,740,692,672,652,660,652,668,692,708,504,176,24,24,64,96,260,412,432,320,232,196,308,412,508,576,616,552,468,452,480,540,592,624,588,524,444,380,364,388,424,440,428,388,356,396,472,536,548,544,520,488,452,488,544,628,676,672,648,632,628,652,700,728,728,716,712,676,652,664,716,756,752,724,696,692,672,668,672,684,560,248,56,12,80,124,248,380,424,344,276,256,352,476,536,572,560,508,432,452,508,580,604,604,536,480,436,444,468,492,460,404,344,320,360,428,508,552,548,492,432,424,472,540,612,636,628,596,580,596,648,696,720,712,664,612,596,624,684,748,756,712,676,672,684,700,740,760,744,684,592,356,108,32,104,180,196,272,332,316,268,292,376,496,528,512,496,488,476,496,560,596,588,532,500,472,488,508,528,520,476,400,340,336,368,444,476,484,472,472,464,472,508,540,560,564,568,584,616,640,660,656,648,636,636,644,652,644,632,628,628,664,728,764,748,712,696,704,720,720,728,708,532,212,12,64,184,236,248,304,300,260,276,388,508,548,504,456,460,492,528,576,604,564,496,464,492,528,544,524,472,412,384,360,372,424,468,460,444,464,500,512,512,508,512,524,544,580,616,640,624,608,612,628,644,648,648,644,620,608,616,632,668,716,736,708,676,688,716,728,704,688,680,552,260,44,104,220,232,196,232,272,276,324,416,504,512,464,444,504,548,560,556,552,524,504,504,528,544,516,480,440,428,404,360,368,408,452,472,492,504,504,500,504,508,528,548,564,580,588,600,612,624,624,624,624,632,640,640,628,616,632,636,648,688,732,720,672,660,704,728,704,668,668,588,336,92,120,268,272,168,148,232,300,344,396,456,476,452,452,528,588,568,512,516,548,560,544,524,512,500,488,472,460,432,352,308,372,464,500,468,448,476,512,536,532,532,544,552,572,608,632,624,608,608,624,640,636,628,624,628,620,612,624,640,648,660,676,672,652,644,660,664,648,628,604,496,300,184,248,340,312,200,164,240,360,408,372,348,400,484,524,520,508,508,536,568,572,556,540,528,520,524,528,512,480,432,388,388,436,472,464,436,432,464,512,532,520,508,528,576,612,616,592,580,600,624,624,600,580,584,600,616,604,572,564,588,616,624,624,620,616,620,632,640,636,632,624,584,500,404,364,380,384,336,272,252,288,336,356,336,324,368,444,496,488,464,488,544,592,588,548,528,544,572,572,524,460,412,416,460,480,452,412,412,456,500,508,488,480,516,580,604,584,556,564,604,636,620,580,564,592,624,628,604,576,580,604,628,624,616,612,612,620,624,624,616,616,628,616,544,440,368,376,392,364,292,252,268,320,344,328,312,348,428,476,476,460,484,540,592,588,552,532,560,584,580,536,500,468,452,440,440,440,436,432,436,456,472,480,488,508,536,568,576,576,576,592,608,616,608,592,596,612,616,612,600,592,600,612,616,616,620,624,616,616,624,628,620,616,616,584,508,420,380,388,380,328,276,268,296,320,316,308,328,388,436,452,452,476,516,560,576,560,548,560,576,576,556,536,516,496,464,436,436,448,448,428,428,448,468,476,480,500,528,556,564,564,576,596,608,612,604,600,604,612,608,604,600,600,600,604,608,616,624,628,620,616,624,632,624,620,612,572,504,432,400,392,372,324,288,288,304,312,308,316,348,392,420,432,452,484,516,548,560,564,560,564,572,572,564,548,528,504,476,452,444,448,448,440,440,448,456,464,476,496,516,536,552,560,572,588,596,604,608,608,604,608,612,608,604,600,596,592,600,612,620,620,612,608,620,632,636,628,616,576,508,448,420,400,364,324,308,304,300,296,300,320,352,376,376,400,444,476,512,556,576,580,580,584,584,592,576,544,524,500,448,404,404,396,392,404,412,416,436,460,480,508,528,552,576,592,604,620,624,624,628,628,628,624,628,632,636,640,636,648,664,672,688,696,680,688,696,696,692,668,592,500,392,336,292,236,200,188,188,204,224,244,292,332,396,456,488,508,536,560,592,600,600,584,568,552,552,536,520,500,476,464,420,400,396,384,388,412,420,432,444,468,496,512,536,560,580,600,616,628,636,628,632,636,632,624,624,620,620,620,620,624,628,644,664,680,676,680,688,704,708,700,636,556,444,384,336,272,228,192,184,192,208,220,252,276,352,412,468,488,520,548,592,612,624,616,592,588,580,572,548,528,496,488,440,428,400,380,376,380,396,408,420,440,468,492,520,540,564,580,604,624,628,628,628,628,628,620,620,620,620,624,628,632,636,644,668,688,692,696,700,708,720,712,656,584,460,404,344,280,236,192,160,196,208,208,244,248,332,416,464,500,516,536,600,616,644,628,600,596,580,580,556,528,504,488,468,444,420,388,368,364,372,384,388,404,432,452,488,512,532,556,580,612,628,636,636,640,640,636,628,624,620,620,620,628,632,640,656,680,700,712,716,724,732,748,720,664,568,460,404,320,276,216,176,164,164,172,200,208,268,332,404,460,496,532,564,604,628,644,628,612,588,584,560,548,520,512,488,468,444,424,400,384,376,372,372,380,400,424,448,480,508,528,556,580,604,624,640,648,652,644,640,636,628,616,612,608,608,616,620,632,656,680,704,716,724,736,752,756,704,640,516,448,372,304,260,188,164,148,152,172,192,216,280,340,424,468,512,544,584,620,644,648,636,616,596,584,564,548,520,512,484,468,448,424,408,388,384,372,376,384,408,428,456,476,508,520,548,580,604,620,636,648,644,644,640,632,616,604,596,596,596,604,608,620,636,664,692,708,724,744,760,760,720,664,536,468,384,320,268,196,168,148,144,160,180,208,264,324,412,456,508,544,588,624,652,660,648,628,612,600,580,556,528,516,496,480,472,436,412,388,392,388,384,388,396,408,436,460,488,508,528,560,576,604,616,636,636,636,636,628,620,608,600,592,592,600,608,612,624,652,676,692,712,740,756,772,752,704,592,512,436,364,308,228,192,152,140,148,172,184,228,288,376,428,488,528,572,608,644,668,668,648,632,620,592,568,544,528,512,488,468,448,420,408,388,388,376,376,392,404,420,440,460,488,512,540,564,584,604,624,636,640,636,640,632,616,608,600,592,588,596,604,600,608,632,648,660,664,684,700,728,724,728,612,520,476,400,360,272,228,208,164,172,200,188,224,260,356,412,448,512,564,592,628,656,668,660,640,644,612,572,544,536,512,488,460,452,416,396,388,372,368,368,384,404,412,440,472,492,520,548,572,596,612,632,640,636,640,640,632,620,608,600,592,584,596,600,600,612,632,648,656,664,684,696,712,716,724,600,504,472,408,344,256,216,212,176,164,208,204,236,292,376,432,460,512,588,608,628,652,668,656,640,628,604,560,528,524,508,476,452,436,416,388,384,376,364,368,392,412,424,444,476,504,520,548,572,588,604,624,636,632,628,632,628,612,604,600,588,584,592,600,604,608,632,648,660,672,688,700,716,720,748,660,496,472,452,356,260,208,196,196,152,172,212,212,256,364,428,452,496,568,624,640,640,668,668,636,628,616,572,524,512,504,480,444,432,428,400,392,400,392,380,392,424,440,444,464,500,516,532,560,580,588,600,624,636,628,620,624,624,612,604,600,592,588,596,608,608,608,628,652,660,668,684,696,692,700,704,580,440,448,468,336,208,216,248,208,168,188,228,248,292,384,452,464,492,580,648,632,608,648,680,640,600,596,584,540,512,512,508,468,452,460,456,432,416,428,444,436,432,456,488,492,496,520,556,564,568,584,604,608,604,608,612,608,592,588,580,568,548,532,528,532,524,512,512,516,520,520,516,524,536,532,524,516,520,520,516,504,488,480,480,480,464,444,444,448,448,436,424,428,440,452,452,456,476,492,500,500,504,516,536,544,540,540,548,560,564,552,544,540,540,536,532,512,504,500,496,500,496,484,484,492,500,504,504,504,512,524,536,536,540,544,548,548,548,544,540,536,536,536,528,516,512,512,512,512,508,500,504,512,512,512,508,512,516,516,516,516,512,516,516,516,512,508,508,504,500,496,488,488,488,484,484,480,484,488,492,492,496,500,504,508,512,512,512,516,516,516,520,520,520,520,520,524,524,520,520,520,520,520,516,516,512,516,516,516,512,512,516,516,516,516,516,520,524,524,520,516,520,520,520,512,512,512,512,512,508,508,508,508,508,508,504,504,508,504,504,504,508,508,508,508,508,508,508,508,512,508,508,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,516,516,512,508,508,512,512,512,512,512,516,516,512,512,512,512,516,516,512,512,512,516,516,512,512,516,516,512,512,508,508,512,512,512,512,516,512,512,512,512,508,512,512,508,512,512,512,512,508,512,516,520,516,512,512,512,516,524,520,512,512,524,524,400,240,304,536,676,576,404,456,680,736,508,320,432,672,700,492,316,392,580,612,484,388,468,600,592,456,428,556,600,524,496,540,608,556,388,384,564,624,496,392,484,596,568,528,540,548,520,504,552,568,480,428,512,628,640,468,364,532,668,520,356,448,616,584,448,432,532,608,580,492,472,596,708,620,428,352,428,564,644,604,460,264,268,512,764,772,476,224,372,724,776,448,228,400,596,540,444,472,536,532,464,472,584,668,628,536,520,556,564,520,472,476,500,488,464,472,484,504,528,520,496,460,476,536,548,500,440,460,548,596,552,460,412,468,512,500,492,468,432,420,436,452,488,508,468,440,488,572,620,592,580,592,548,476,476,552,600,536,468,440,460,524,572,524,448,460,512,508,492,504,484,460,480,480,484,512,488,456,496,552,576,592,548,476,504,596,620,600,588,532,508,564,592,560,532,524,504,460,476,524,548,536,468,432,492,556,596,552,476,488,552,556,488,464,548,592,528,464,472,536,568,540,500,496,528,524,460,432,512,604,600,480,368,440,564,564,488,448,464,512,556,496,380,448,620,596,408,304,400,616,692,532,360,376,508,584,564,508,492,524,512,460,512,624,592,432,364,520,668,596,416,392,584,696,548,376,456,636,652,516,440,492,572,564,512,520,528,472,436,492,544,520,472,484,524,512,496,568,636,560,472,508,568,516,464,500,528,512,484,480,480,504,524,504,468,476,508,512,492,488,520,532,484,460,536,564,468,372,424,568,612,548,472,428,464,564,620,524,424,464,552,564,512,480,516,560,548,504,516,584,584,504,480,564,600,516,452,496,536,512,492,508,528,540,516,508,536,576,568,516,480,484,512,512,488,468,484,516,520,488,476,492,488,472,468,492,504,504,504,492,492,532,552,508,492,516,528,504,460,492,560,564,512,508,540,540,484,456,520,596,560,440,428,492,572,604,556,540,552,516,484,496,556,576,516,436,404,468,552,556,496,460,472,488,488,484,508,548,556,536,512,508,512,524,548,544,500,472,512,560,536,492,484,512,512,484,484,532,588,588,536,492,484,500,536,564,560,528,516,524,520,496,484,508,520,504,476,480,504,512,492,472,496,512,492,460,468,504,520,520,512,484,460,472,512,552,540,496,468,480,508,512,504,500,504,504,492,484,512,560,572,540,512,508,500,488,504,564,604,576,536,516,512,516,520,540,556,552,524,512,520,516,504,512,544,548,520,500,512,508,476,452,480,520,528,504,492,512,528,520,504,496,504,508,500,500,508,512,512,500,484,488,504,504,500,500,512,508,484,472,492,520,536,528,512,512,516,516,528,544,552,532,512,508,512,516,520,516,512,504,504,504,504,496,496,516,536,524,504,500,508,512,512,512,516,524,520,512,508,504,500,500,504,504,500,504,508,512,512,504,504,512,516,524,528,532,532,524,512,512,516,524,528,528,516,512,508,508,508,508,512,512,520,520,512,504,508,512,512,512,520,528,524,512,504,508,516,520,512,508,512,512,508,496,500,512,512,512,508,508,508,508,504,512,516,516,508,496,500,512,520,520,512,508};
//int audioData[5000];

int tim_counter_val, audio_counter;
int tim_interrupt = 0;
/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  *
  * @retval None
  */
int main(void)
{
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration----------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_DMA_Init();
  MX_DAC1_Init();
  MX_TIM2_Init();
  MX_USART1_UART_Init();
  /* USER CODE BEGIN 2 */

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
	audio_counter = 0;
	HAL_DAC_Start(&hdac1, DAC_CHANNEL_1);
	HAL_DAC_Start(&hdac1, DAC_CHANNEL_2);
		
  while (1)
  {

		/* USER CODE END WHILE */
		HAL_TIM_Base_Start_IT(&htim2);

		/* USER CODE BEGIN 3 */		
		//if (HAL_UART_Receive(&huart1, (uint8_t *)&audioData[0], 5000, 8000) == HAL_OK){			
		//	HAL_GPIO_WritePin(GPIOB, GPIO_PIN_14, GPIO_PIN_SET);
		//}
		
		if(!HAL_GPIO_ReadPin(GPIOC, GPIO_PIN_13)){
			HAL_GPIO_WritePin(GPIOB, GPIO_PIN_14, GPIO_PIN_SET);
		
			if(tim_interrupt){
				tim_interrupt = 0;
				
				HAL_DAC_SetValue(&hdac1, DAC_CHANNEL_1, DAC_ALIGN_12B_R, audioData[audio_counter]);
				HAL_DAC_SetValue(&hdac1, DAC_CHANNEL_2, DAC_ALIGN_12B_R, audioData[audio_counter]);
				
				audio_counter++;
				
				if(audio_counter == 5000){
					audio_counter = 0;
				}
			} else {
				HAL_GPIO_WritePin(GPIOB, GPIO_PIN_14, GPIO_PIN_RESET);
			}
		} 
	}
  
  /* USER CODE END 3 */

}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{

  RCC_OscInitTypeDef RCC_OscInitStruct;
  RCC_ClkInitTypeDef RCC_ClkInitStruct;
  RCC_PeriphCLKInitTypeDef PeriphClkInit;

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_MSI;
  RCC_OscInitStruct.MSIState = RCC_MSI_ON;
  RCC_OscInitStruct.MSICalibrationValue = 0;
  RCC_OscInitStruct.MSIClockRange = RCC_MSIRANGE_6;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_MSI;
  RCC_OscInitStruct.PLL.PLLM = 1;
  RCC_OscInitStruct.PLL.PLLN = 40;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV7;
  RCC_OscInitStruct.PLL.PLLQ = RCC_PLLQ_DIV2;
  RCC_OscInitStruct.PLL.PLLR = RCC_PLLR_DIV2;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV1;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_4) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

  PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_USART1;
  PeriphClkInit.Usart1ClockSelection = RCC_USART1CLKSOURCE_PCLK2;
  if (HAL_RCCEx_PeriphCLKConfig(&PeriphClkInit) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Configure the main internal regulator output voltage 
    */
  if (HAL_PWREx_ControlVoltageScaling(PWR_REGULATOR_VOLTAGE_SCALE1) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Configure the Systick interrupt time 
    */
  HAL_SYSTICK_Config(HAL_RCC_GetHCLKFreq()/1000);

    /**Configure the Systick 
    */
  HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);

  /* SysTick_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(SysTick_IRQn, 0, 0);
}

/* DAC1 init function */
static void MX_DAC1_Init(void)
{

  DAC_ChannelConfTypeDef sConfig;

    /**DAC Initialization 
    */
  hdac1.Instance = DAC1;
  if (HAL_DAC_Init(&hdac1) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**DAC channel OUT1 config 
    */
  sConfig.DAC_SampleAndHold = DAC_SAMPLEANDHOLD_DISABLE;
  sConfig.DAC_Trigger = DAC_TRIGGER_NONE;
  sConfig.DAC_OutputBuffer = DAC_OUTPUTBUFFER_ENABLE;
  sConfig.DAC_ConnectOnChipPeripheral = DAC_CHIPCONNECT_DISABLE;
  sConfig.DAC_UserTrimming = DAC_TRIMMING_FACTORY;
  if (HAL_DAC_ConfigChannel(&hdac1, &sConfig, DAC_CHANNEL_1) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**DAC channel OUT2 config 
    */
  sConfig.DAC_ConnectOnChipPeripheral = DAC_CHIPCONNECT_DISABLE;
  if (HAL_DAC_ConfigChannel(&hdac1, &sConfig, DAC_CHANNEL_2) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/* TIM2 init function */
static void MX_TIM2_Init(void)
{

  TIM_ClockConfigTypeDef sClockSourceConfig;
  TIM_MasterConfigTypeDef sMasterConfig;

  htim2.Instance = TIM2;
  htim2.Init.Prescaler = 100;
  htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim2.Init.Period = 100;
  htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim2.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  if (HAL_TIM_Base_Init(&htim2) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

  sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
  if (HAL_TIM_ConfigClockSource(&htim2, &sClockSourceConfig) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim2, &sMasterConfig) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/* USART1 init function */
static void MX_USART1_UART_Init(void)
{

  huart1.Instance = USART1;
  huart1.Init.BaudRate = 115200;
  huart1.Init.WordLength = UART_WORDLENGTH_8B;
  huart1.Init.StopBits = UART_STOPBITS_1;
  huart1.Init.Parity = UART_PARITY_NONE;
  huart1.Init.Mode = UART_MODE_TX_RX;
  huart1.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart1.Init.OverSampling = UART_OVERSAMPLING_16;
  huart1.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_DISABLE;
  huart1.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT;
  if (HAL_UART_Init(&huart1) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/** 
  * Enable DMA controller clock
  */
static void MX_DMA_Init(void) 
{
  /* DMA controller clock enable */
  __HAL_RCC_DMA1_CLK_ENABLE();

  /* DMA interrupt init */
  /* DMA1_Channel4_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(DMA1_Channel4_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(DMA1_Channel4_IRQn);
  /* DMA1_Channel5_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(DMA1_Channel5_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(DMA1_Channel5_IRQn);

}

/** Configure pins as 
        * Analog 
        * Input 
        * Output
        * EVENT_OUT
        * EXTI
     PC0   ------> ADCx_IN1
     PC1   ------> ADCx_IN2
     PC2   ------> ADCx_IN3
     PC3   ------> ADCx_IN4
     PA0   ------> UART4_TX
     PA1   ------> UART4_RX
     PA4   ------> SharedAnalog_PA4
     PA6   ------> SPI1_MISO
     PA7   ------> SPI1_MOSI
     PC4   ------> ADCx_IN13
     PC5   ------> ADCx_IN14
     PB1   ------> ADCx_IN16
     PE7   ------> S_DATAIN2DFSDM1
     PE9   ------> S_CKOUTDFSDM1
     PE10   ------> QUADSPI_CLK
     PE11   ------> QUADSPI_NCS
     PE12   ------> QUADSPI_BK1_IO0
     PE13   ------> QUADSPI_BK1_IO1
     PE14   ------> QUADSPI_BK1_IO2
     PE15   ------> QUADSPI_BK1_IO3
     PB10   ------> I2C2_SCL
     PB11   ------> I2C2_SDA
     PD8   ------> USART3_TX
     PD9   ------> USART3_RX
     PA9   ------> USB_OTG_FS_VBUS
     PA10   ------> USB_OTG_FS_ID
     PA11   ------> USB_OTG_FS_DM
     PA12   ------> USB_OTG_FS_DP
     PC10   ------> SPI3_SCK
     PC11   ------> SPI3_MISO
     PC12   ------> SPI3_MOSI
     PD1   ------> SPI2_SCK
     PD3   ------> USART2_CTS
     PD4   ------> USART2_RTS
     PD5   ------> USART2_TX
     PD6   ------> USART2_RX
     PB8   ------> I2C1_SCL
     PB9   ------> I2C1_SDA
*/
static void MX_GPIO_Init(void)
{

  GPIO_InitTypeDef GPIO_InitStruct;

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOE_CLK_ENABLE();
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOE, M24SR64_Y_RF_DISABLE_Pin|M24SR64_Y_GPO_Pin|ISM43362_RST_Pin|ISM43362_SPI3_CSN_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOA, ARD_D10_Pin|SPBTLE_RF_RST_Pin|ARD_D9_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOB, ARD_D8_Pin|ISM43362_BOOT0_Pin|ISM43362_WAKEUP_Pin|LED2_Pin 
                          |SPSGRF_915_SDN_Pin|ARD_D5_Pin|SPSGRF_915_SPI3_CSN_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, USB_OTG_FS_PWR_EN_Pin|SPBTLE_RF_SPI3_CSN_Pin|PMOD_RESET_Pin|STSAFE_A100_RESET_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOC, VL53L0X_XSHUT_Pin|LED3_WIFI__LED4_BLE_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pins : M24SR64_Y_RF_DISABLE_Pin M24SR64_Y_GPO_Pin ISM43362_RST_Pin ISM43362_SPI3_CSN_Pin */
  GPIO_InitStruct.Pin = M24SR64_Y_RF_DISABLE_Pin|M24SR64_Y_GPO_Pin|ISM43362_RST_Pin|ISM43362_SPI3_CSN_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pins : USB_OTG_FS_OVRCR_EXTI3_Pin SPSGRF_915_GPIO3_EXTI5_Pin SPBTLE_RF_IRQ_EXTI6_Pin ISM43362_DRDY_EXTI1_Pin */
  GPIO_InitStruct.Pin = USB_OTG_FS_OVRCR_EXTI3_Pin|SPSGRF_915_GPIO3_EXTI5_Pin|SPBTLE_RF_IRQ_EXTI6_Pin|ISM43362_DRDY_EXTI1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pin : BUTTON_EXTI13_Pin */
  GPIO_InitStruct.Pin = BUTTON_EXTI13_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_FALLING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(BUTTON_EXTI13_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_A5_Pin ARD_A4_Pin ARD_A3_Pin ARD_A2_Pin 
                           ARD_A1_Pin ARD_A0_Pin */
  GPIO_InitStruct.Pin = ARD_A5_Pin|ARD_A4_Pin|ARD_A3_Pin|ARD_A2_Pin 
                          |ARD_A1_Pin|ARD_A0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG_ADC_CONTROL;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_D1_Pin ARD_D0_Pin */
  GPIO_InitStruct.Pin = ARD_D1_Pin|ARD_D0_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF8_UART4;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_D10_Pin SPBTLE_RF_RST_Pin ARD_D9_Pin */
  GPIO_InitStruct.Pin = ARD_D10_Pin|SPBTLE_RF_RST_Pin|ARD_D9_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pin : ARD_D7_Pin */
  GPIO_InitStruct.Pin = ARD_D7_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(ARD_D7_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_D12_Pin ARD_D11_Pin */
  GPIO_InitStruct.Pin = ARD_D12_Pin|ARD_D11_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pin : ARD_D3_Pin */
  GPIO_InitStruct.Pin = ARD_D3_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(ARD_D3_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : ARD_D6_Pin */
  GPIO_InitStruct.Pin = ARD_D6_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_ANALOG_ADC_CONTROL;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(ARD_D6_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_D8_Pin ISM43362_BOOT0_Pin ISM43362_WAKEUP_Pin LED2_Pin 
                           SPSGRF_915_SDN_Pin ARD_D5_Pin SPSGRF_915_SPI3_CSN_Pin */
  GPIO_InitStruct.Pin = ARD_D8_Pin|ISM43362_BOOT0_Pin|ISM43362_WAKEUP_Pin|LED2_Pin 
                          |SPSGRF_915_SDN_Pin|ARD_D5_Pin|SPSGRF_915_SPI3_CSN_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pins : DFSDM1_DATIN2_Pin DFSDM1_CKOUT_Pin */
  GPIO_InitStruct.Pin = DFSDM1_DATIN2_Pin|DFSDM1_CKOUT_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF6_DFSDM1;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pins : QUADSPI_CLK_Pin QUADSPI_NCS_Pin OQUADSPI_BK1_IO0_Pin QUADSPI_BK1_IO1_Pin 
                           QUAD_SPI_BK1_IO2_Pin QUAD_SPI_BK1_IO3_Pin */
  GPIO_InitStruct.Pin = QUADSPI_CLK_Pin|QUADSPI_NCS_Pin|OQUADSPI_BK1_IO0_Pin|QUADSPI_BK1_IO1_Pin 
                          |QUAD_SPI_BK1_IO2_Pin|QUAD_SPI_BK1_IO3_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_QUADSPI;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pins : INTERNAL_I2C2_SCL_Pin INTERNAL_I2C2_SDA_Pin */
  GPIO_InitStruct.Pin = INTERNAL_I2C2_SCL_Pin|INTERNAL_I2C2_SDA_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF4_I2C2;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pins : INTERNAL_UART3_TX_Pin INTERNAL_UART3_RX_Pin */
  GPIO_InitStruct.Pin = INTERNAL_UART3_TX_Pin|INTERNAL_UART3_RX_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF7_USART3;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : LPS22HB_INT_DRDY_EXTI0_Pin LSM6DSL_INT1_EXTI11_Pin ARD_D2_Pin HTS221_DRDY_EXTI15_Pin 
                           PMOD_IRQ_EXTI12_Pin */
  GPIO_InitStruct.Pin = LPS22HB_INT_DRDY_EXTI0_Pin|LSM6DSL_INT1_EXTI11_Pin|ARD_D2_Pin|HTS221_DRDY_EXTI15_Pin 
                          |PMOD_IRQ_EXTI12_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : USB_OTG_FS_PWR_EN_Pin SPBTLE_RF_SPI3_CSN_Pin PMOD_RESET_Pin STSAFE_A100_RESET_Pin */
  GPIO_InitStruct.Pin = USB_OTG_FS_PWR_EN_Pin|SPBTLE_RF_SPI3_CSN_Pin|PMOD_RESET_Pin|STSAFE_A100_RESET_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : VL53L0X_XSHUT_Pin LED3_WIFI__LED4_BLE_Pin */
  GPIO_InitStruct.Pin = VL53L0X_XSHUT_Pin|LED3_WIFI__LED4_BLE_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pins : VL53L0X_GPIO1_EXTI7_Pin LSM3MDL_DRDY_EXTI8_Pin */
  GPIO_InitStruct.Pin = VL53L0X_GPIO1_EXTI7_Pin|LSM3MDL_DRDY_EXTI8_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : USB_OTG_FS_VBUS_Pin */
  GPIO_InitStruct.Pin = USB_OTG_FS_VBUS_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(USB_OTG_FS_VBUS_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : USB_OTG_FS_ID_Pin USB_OTG_FS_DM_Pin USB_OTG_FS_DP_Pin */
  GPIO_InitStruct.Pin = USB_OTG_FS_ID_Pin|USB_OTG_FS_DM_Pin|USB_OTG_FS_DP_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF10_OTG_FS;
  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /*Configure GPIO pins : INTERNAL_SPI3_SCK_Pin INTERNAL_SPI3_MISO_Pin INTERNAL_SPI3_MOSI_Pin */
  GPIO_InitStruct.Pin = INTERNAL_SPI3_SCK_Pin|INTERNAL_SPI3_MISO_Pin|INTERNAL_SPI3_MOSI_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : PMOD_SPI2_SCK_Pin */
  GPIO_InitStruct.Pin = PMOD_SPI2_SCK_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
  HAL_GPIO_Init(PMOD_SPI2_SCK_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : PMOD_UART2_CTS_Pin PMOD_UART2_RTS_Pin PMOD_UART2_TX_Pin PMOD_UART2_RX_Pin */
  GPIO_InitStruct.Pin = PMOD_UART2_CTS_Pin|PMOD_UART2_RTS_Pin|PMOD_UART2_TX_Pin|PMOD_UART2_RX_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF7_USART2;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : ARD_D15_Pin ARD_D14_Pin */
  GPIO_InitStruct.Pin = ARD_D15_Pin|ARD_D14_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  GPIO_InitStruct.Alternate = GPIO_AF4_I2C1;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /* EXTI interrupt init*/
  HAL_NVIC_SetPriority(EXTI9_5_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(EXTI9_5_IRQn);

  HAL_NVIC_SetPriority(EXTI15_10_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(EXTI15_10_IRQn);

}

/* USER CODE BEGIN 4 */

/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @param  file: The file name as string.
  * @param  line: The line in file as a number.
  * @retval None
  */
void _Error_Handler(char *file, int line)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  while(1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t* file, uint32_t line)
{ 
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     tex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */

/**
  * @}
  */

/**
  * @}
  */

/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
